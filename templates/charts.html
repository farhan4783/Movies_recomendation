{% extends "base.html" %}
{% block title %}Top Charts - Movie Maverick{% endblock %}

{% block head %}
<style>
    .charts-hero {
        background: linear-gradient(135deg, rgba(102, 126, 234, 0.15) 0%, rgba(118, 75, 162, 0.1) 100%);
        border-radius: 24px;
        padding: 3rem 2rem 2rem;
        margin-bottom: 3rem;
        text-align: center;
        border: 1px solid rgba(102, 126, 234, 0.2);
    }

    .charts-hero h1 {
        font-size: 3rem;
        font-weight: 800;
        margin-bottom: 0.5rem;
    }

    .genre-tabs {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
        justify-content: center;
        margin-bottom: 3rem;
    }

    .genre-tab {
        padding: 0.5rem 1.25rem;
        border-radius: 50px;
        border: 1px solid var(--glass-border);
        background: rgba(255, 255, 255, 0.05);
        color: var(--text-secondary);
        cursor: pointer;
        font-size: 0.85rem;
        font-weight: 500;
        transition: all 0.25s;
        text-decoration: none;
    }

    .genre-tab.active,
    .genre-tab:hover {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border-color: #667eea;
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
    }

    .chart-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .chart-item {
        display: flex;
        align-items: center;
        gap: 1.25rem;
        padding: 1rem 1.25rem;
        background: var(--card-bg);
        border: 1px solid var(--glass-border);
        border-radius: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        color: inherit;
        animation: fadeInUp 0.4s ease backwards;
    }

    .chart-item:hover {
        transform: translateX(8px);
        border-color: rgba(102, 126, 234, 0.5);
        box-shadow: 0 8px 30px rgba(102, 126, 234, 0.15);
        background: rgba(102, 126, 234, 0.05);
    }

    .chart-rank {
        font-size: 1.5rem;
        font-weight: 900;
        min-width: 50px;
        text-align: center;
        font-family: var(--font-heading);
    }

    .rank-1 {
        background: linear-gradient(135deg, #ffd700, #ff8c00);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-size: 2rem;
    }

    .rank-2 {
        background: linear-gradient(135deg, #c0c0c0, #888);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-size: 1.8rem;
    }

    .rank-3 {
        background: linear-gradient(135deg, #cd7f32, #a0522d);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-size: 1.7rem;
    }

    .chart-poster {
        width: 55px;
        height: 82px;
        object-fit: cover;
        border-radius: 10px;
        flex-shrink: 0;
        background: rgba(255, 255, 255, 0.05);
    }

    .chart-info {
        flex: 1;
    }

    .chart-title {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 0.3rem;
    }

    .chart-meta {
        color: var(--text-secondary);
        font-size: 0.85rem;
        display: flex;
        gap: 1rem;
        align-items: center;
    }

    .chart-rating {
        color: #ffd700;
        font-weight: 600;
        font-size: 1rem;
    }

    .chart-genre-badge {
        background: rgba(102, 126, 234, 0.15);
        border: 1px solid rgba(102, 126, 234, 0.3);
        color: #8fa4f3;
        border-radius: 50px;
        padding: 0.2rem 0.75rem;
        font-size: 0.75rem;
        font-weight: 500;
    }
</style>
{% endblock %}

{% block content %}
<div class="container" style="padding-top: 5rem;">
    <div class="charts-hero" data-animate="fadeInUp">
        <h1>üìä Top Charts</h1>
        <p style="color: var(--text-secondary); font-size: 1.1rem;">The highest-rated films, filtered by genre.</p>
    </div>

    <!-- Genre Filter Tabs -->
    <div class="genre-tabs">
        <a href="/charts" class="genre-tab {{ 'active' if selected_genre == 'All' else '' }}">All Genres</a>
        {% for g in genres %}
        <a href="/charts?genre={{ g|urlencode }}" class="genre-tab {{ 'active' if selected_genre == g else '' }}">{{ g
            }}</a>
        {% endfor %}
    </div>

    <!-- Chart List -->
    {% if top_movies %}
    <div class="chart-list">
        {% for movie in top_movies %}
        <a class="chart-item" href="/movie/{{ movie.title|urlencode }}"
            style="animation-delay: {{ loop.index0 * 0.04 }}s">
            <div
                class="chart-rank {{ 'rank-1' if loop.index == 1 else ('rank-2' if loop.index == 2 else ('rank-3' if loop.index == 3 else '')) }}">
                {{ loop.index }}
            </div>
            {% if movie.poster_path %}
            <img src="{{ movie.poster_path }}" alt="{{ movie.title }}" class="chart-poster" loading="lazy">
            {% else %}
            <div class="chart-poster" style="display:flex;align-items:center;justify-content:center;font-size:1.5rem;">
                üé¨</div>
            {% endif %}
            <div class="chart-info">
                <div class="chart-title">{{ movie.title }}</div>
                <div class="chart-meta">
                    <span class="chart-rating">‚≠ê {{ "%.1f"|format(movie.vote_average|float) if movie.vote_average and
                        movie.vote_average != 'N/A' else 'N/A' }}</span>
                    <span class="chart-genre-badge">{{ movie.genre.split('|')[0] if movie.genre else 'Film' }}</span>
                    <span>{{ movie.release_date[:4] if movie.release_date else '' }}</span>
                </div>
            </div>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                style="color: var(--text-tertiary); flex-shrink:0;">
                <path d="M9 18l6-6-6-6" />
            </svg>
        </a>
        {% endfor %}
    </div>
    {% else %}
    <div style="text-align:center; padding: 4rem; color: var(--text-secondary);">
        <div style="font-size:3rem; margin-bottom:1rem;">üé¨</div>
        <p>No movies found for this genre. Try a different filter.</p>
    </div>
    {% endif %}
</div>
{% endblock %}